<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.Basic.Mapper.UserMapper">
 
    <!-- 회원가입 -->
    <insert id="userInsert">
        insert into user (uid,upass,uname,umail01,umail02) values(#{uid},#{upass},#{uname},#{umail01},#{umail02})
    </insert>
    
    <!-- 아이디 중복 체크 -->
	<select id="idChk" resultType="int">
		select COUNT(*) from user where uid = #{uid}
	</select>
	
	<!-- 닉네임 중복 체크 -->
	<select id="unameChk" resultType="int">
		select COUNT(*) from user where uname = #{uname}
	</select>
    
    <!-- 로그인 -->
    <select id="login" resultType="com.Basic.Domain.UserVO">
    	select * from user where uid= #{uid} and upass= #{upass}
	</select>
	
	<!-- 글 작성 -->
	<insert id="boardInsert">
        insert into board (unum,uname,sub,content,cate01,cate02,writedate,file,delyn) 
        values(#{unum},#{uname},#{sub},#{content},#{cate01},#{cate02},SYSDATE(),#{file},"N")
    </insert>
    
    <!-- 게시판 리스트보기 -->
    <select id="listAll" resultType="com.Basic.Domain.BoardVO">
    <![CDATA[    
        select * from board where delyn = "N"
        order by bnum DESC limit #{pageStart}, #{perPageNum}
    ]]>
    </select>
    
    <!-- 총 갯수 -->
    <select id="listCount" resultType="int">
    <![CDATA[
        SELECT COUNT(*) FROM board WHERE bnum > 0 and delyn = "N"
    ]]>
    </select>
    
    <!-- 게시판 상세보기 -->
    <select id="detailView" resultType="com.Basic.Domain.BoardVO">
            select * from board where bnum = #{bnum} and delyn = "N"
    </select>
    
    <!-- 조회수 -->
   	<update id="viewCount" parameterType="int">
    	update board set viewcount = viewcount+1 where bnum = #{bnum}
    </update>
    	
	<!-- 게시판 수정하기 -->
    <update id="updateBoard" parameterType="com.Basic.Domain.BoardVO">
        update board set cate01=#{cate01} ,cate02=#{cate02} ,sub=#{sub} ,content=#{content} where bnum = #{bnum}
    </update>
    
    <!-- 게시판 글 삭제하기 -->
    <update id="delete" parameterType="int">
        update board set delyn="Y" where bnum = #{bnum}
    </update>
    
    <!-- 게시판 진짜 삭제하기 -->
    <delete id="deleteReal" parameterType="int">
    	delete from board where bnum = #{bnum}
    </delete>
    
    <!-- 이전글 -->
    <select id="before" resultType="Integer">    
    <![CDATA[
    	select max(bnum) as bnum from board where bnum < #{bnum} and delyn = "N"   
    ]]>
	</select>
	
	<!-- 다음글 -->
    <select id="after" resultType="Integer">    
    <![CDATA[
    	select min(bnum) as bnum from board where bnum > #{bnum} and delyn = "N"   
    ]]>
	</select>
		
</mapper>